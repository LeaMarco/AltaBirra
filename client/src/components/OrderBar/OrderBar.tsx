import React, { useState } from "react";
import { useEffect } from "react";
import { useDispatch, useSelector } from "react-redux";
import { QueryTypes, searchedPosts, setQuerySearch } from "../../actions";
import { RootState } from "../../reducers";
import Style from "./OrderBar.module.css";

export default function OrderBar() {
	const dispatch = useDispatch();
	const searchQuery: QueryTypes = useSelector((state: RootState) => state.postsSearchQuery);
	const posts: any = useSelector((state: RootState) => state.searchedPosts);
	const [page, setPage] = useState(searchQuery.page || 0);
	const { genericType, specificType, rating, hasDiscount, hasShipping, maxAbv, maxIbu, maxOg, minAbv, minOg, minIbu, minCalories, maxCalories, maxPrice, minPrice, hasDryHop, title } = searchQuery;

	function handleChange(event) {
		dispatch(setQuerySearch({ orderBy: event.target.value }));
		setPage(0);
	}

	useEffect(() => {
		dispatch(searchedPosts(searchQuery));
	}, [searchQuery.orderBy, searchQuery.page])

	useEffect(() => {
		dispatch(setQuerySearch({ page }));
	}, [page]);

	useEffect(() => {
		setPage(0);
	}, [genericType, specificType, rating, hasDiscount, hasShipping, maxAbv, maxIbu, maxOg, minAbv, minOg, minIbu, minCalories, maxCalories, maxPrice, minPrice, hasDryHop, title])

	return (
		<div className={Style.container} >
			<button className={Style.goToLeftOrRightButtons} onClick={page ? () => setPage(page - 1) : undefined}
				style={{ marginRight: "0.25vw", backgroundColor: page ? "#f49e51" : "grey" }}>
				◀
			</button>

			<button className={Style.goToLeftOrRightButtons} onClick={posts?.length === 12 ? () => setPage(page + 1) : undefined} style={{ marginLeft: "0.25vw", backgroundColor: posts?.length === 12 ? "#f49e51" : "grey" }}> ▶ </button>
			<div>
				<label> Ordenar por </label>
				<select id={Style.select} onChange={event => handleChange(event)} value={searchQuery.orderBy}>
					<option className={Style.option}> Mejor resultado </option>
					<option className={Style.option}> Menor precio </option>
					<option className={Style.option}> Mayor precio </option>
					<option className={Style.option}> Menor IBU </option>
					<option className={Style.option}> Mayor IBU </option>
					<option className={Style.option}> Menor ABV </option>
					<option className={Style.option}> Mayor ABV </option>
					<option className={Style.option}> Mejor rating </option>
				</select>
			</div>
		</div>
	)
}


























































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































































//franco 🐈